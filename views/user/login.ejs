<link rel="stylesheet" href="/stylesheet/user/login.css">
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">

<div class="login-panel">
    <div class="key-icon">
        <img src="/img/key_img.png" alt="" style="height: 200px;">
    </div>
    <h2>ADMIN PANEL</h2>
    <form id="login-form" action="/user/login" method="post">
        <!-- Hidden input to pass server message -->
        <input type="hidden" id="message" value="<%= message %>">
        
        <div class="form-group">
            <input name="email" id="Email" type="email" class="form-control" placeholder="Email">
        </div>
        <div class="form-group">
            <input name="password" id="Password" type="password" class="form-control" placeholder="Password">
        </div>
        <button type="submit" class="btn btn-primary btn-block">Login</button>
    </form>
</div>

<script src="https://kit.fontawesome.com/a076d05399.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        document.querySelector('#login-form').addEventListener('submit', formValidateLogin);

        // Show alert immediately if there's a message from server
        const message = document.getElementById('message').value;
        if (message === 'Invalid Password' || message === 'Invalid credentials') {
            Swal.fire({
                icon: 'error',
                title: 'Oops...',
                text: message
            });
        }
    });

    function formValidateLogin(e) {
        e.preventDefault(); // Prevent default form submission
        const email = document.getElementById('Email').value.trim();
        const password = document.getElementById('Password').value.trim();

        if (email === '' || password === '') {
            Swal.fire({
                icon: "error",
                title: "Oops...",
                text: "All Fields Are Required!"
            });
            return false;
        }

        // If validation passes
        e.target.submit();
        return true;
    }
</script>
